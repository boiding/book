<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Sphere of influence - Boiding</title>
        <!-- Custom HTML head -->
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="A workbook for the boiding workshop">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">
        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">
        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <!-- MathJax -->
        <script async type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../boiding.html">Boiding</a></li><li class="chapter-item expanded "><a href="../expect.html"><strong aria-hidden="true">1.</strong> What to expect</a></li><li class="chapter-item expanded "><a href="../background.html"><strong aria-hidden="true">2.</strong> Background</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../background/boid.html"><strong aria-hidden="true">2.1.</strong> Boid</a></li><li class="chapter-item expanded "><a href="../background/key.html"><strong aria-hidden="true">2.2.</strong> Key Ideas</a></li><li class="chapter-item expanded "><a href="../background/alignment.html"><strong aria-hidden="true">2.3.</strong> Alignment</a></li><li class="chapter-item expanded "><a href="../background/cohesion.html"><strong aria-hidden="true">2.4.</strong> Cohesion</a></li><li class="chapter-item expanded "><a href="../background/separation.html"><strong aria-hidden="true">2.5.</strong> Separation</a></li><li class="chapter-item expanded "><a href="../background/others.html"><strong aria-hidden="true">2.6.</strong> Others</a></li></ol></li><li class="chapter-item expanded "><a href="../plan.html"><strong aria-hidden="true">3.</strong> Plan</a></li><li class="chapter-item expanded "><a href="../server.html"><strong aria-hidden="true">4.</strong> Web Server</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../server/responsibilities.html"><strong aria-hidden="true">4.1.</strong> Responsibilities</a></li><li class="chapter-item expanded "><a href="../server/representation.html"><strong aria-hidden="true">4.2.</strong> Representation</a></li></ol></li><li class="chapter-item expanded "><a href="../brain.html"><strong aria-hidden="true">5.</strong> Brain</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../brain/birth.html"><strong aria-hidden="true">5.1.</strong> Birth</a></li><li class="chapter-item expanded "><a href="../brain/system.html"><strong aria-hidden="true">5.2.</strong> System Check</a></li><li class="chapter-item expanded "><a href="../brain/first.html"><strong aria-hidden="true">5.3.</strong> First Flight</a></li><li class="chapter-item expanded "><a href="../brain/north.html"><strong aria-hidden="true">5.4.</strong> Due North</a></li><li class="chapter-item expanded "><a href="../brain/circles.html"><strong aria-hidden="true">5.5.</strong> Going in Circles</a></li><li class="chapter-item expanded "><a href="../brain/alignment.html"><strong aria-hidden="true">5.6.</strong> Alignment</a></li><li class="chapter-item expanded "><a href="../brain/cohesion.html"><strong aria-hidden="true">5.7.</strong> Cohesion</a></li><li class="chapter-item expanded "><a href="../brain/separation.html"><strong aria-hidden="true">5.8.</strong> Separation</a></li><li class="chapter-item expanded "><a href="../brain/balance.html"><strong aria-hidden="true">5.9.</strong> Balance</a></li><li class="chapter-item expanded "><a href="../brain/sphere.html" class="active"><strong aria-hidden="true">5.10.</strong> Sphere of influence</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Boiding</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="sphere-of-influence"><a class="header" href="#sphere-of-influence">Sphere of influence</a></h1>
<p>At the moment the a boid sees all of their flock mates. Even when they are very far away. That isn't realistic.  We our going to remedy that in this section.</p>
<p>Instead of letting each boid influence every single flock mate, we are going to limit their sphere of influence, i.e. boid will only act on flock mates that are within a certain distance.</p>
<p>To achieve this we need to change our brain function. Instead of passing the entire flock to each brain call, we need to filter the flock to only contain boids in the sphere of influence. Let's first make a function that can calculate the distance between two boids</p>
<pre><code>begin distance(boid, mate)
    dx = mate.x - boid.x
    dy = mate.y - boid.y
    sqrt(dx*dx + dy*dy)
end
</code></pre>
<p>This functions determines the <a href="https://en.wikipedia.org/wiki/Euclidean_distance"><em>euclidean distance</em></a> between two boids.</p>
<p>With this function we can determine the sphere of influence. Our main process is controlled by a function that works like this</p>
<pre><code>begin process(flock)
    result = {}
    for name in flock begin
        b = behavior(flock[name], flock)
        result[name] = b
    end
end
</code></pre>
<p>We will need to change that to accomodate the sphere of influence. For this we will create a function that will return the sphere of influence.</p>
<pre><code>begin sphere(boid, flock)
    sphere = []
    for name in flock begin
        mate = flock[name]
        if distance(boid, mate) &lt; radius then begin
            sphere[name] = mate
        end
    end
    sphere
end
</code></pre>
<p>Note that this function is dependent on a <code>radius</code> parameter. A radius of approximatly <code>1.414</code> is the entire world. So pick something that strikes your fancy.</p>
<p>With this <code>sphere</code> function we can change the process function to</p>
<pre><code>begin process(flock)
    result = {}
    for name in flock begin
        boid = flock[name]
        sphere = sphere(boid, flock)
        b = behavior(boid, sphere)
        result[name] = b
    end
end

</code></pre>
<h2 id="experimentation"><a class="header" href="#experimentation">Experimentation</a></h2>
<p>As mentioned before a <code>radius</code> of <code>1.414</code> or more precisely \(\sqrt 2\), will include every flock mate in the sphere of influence. Try out different values and watch the result. Try to increase the number of boids, to see a clearer difference.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../brain/balance.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../brain/balance.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
            </nav>

        </div>

        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        <script type="text/javascript" src="../src/js/widgets.js"></script>
    </body>
</html>
